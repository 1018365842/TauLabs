\hypertarget{group___p_i_o_s___a_d_c}{\section{A\-D\-C Functions}
\label{group___p_i_o_s___a_d_c}\index{A\-D\-C Functions@{A\-D\-C Functions}}
}


S\-T\-M32 A\-D\-C P\-I\-O\-S interface.  


\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{pios__adc_8h}{pios\-\_\-adc.\-h}
\begin{DoxyCompactList}\small\item\em A\-D\-C functions header. \end{DoxyCompactList}\item 
file \hyperlink{pios__adc__priv_8h}{pios\-\_\-adc\-\_\-priv.\-h}
\begin{DoxyCompactList}\small\item\em A\-D\-C private definitions. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structpios__adc__cfg}{pios\-\_\-adc\-\_\-cfg}
\item 
struct \hyperlink{structpios__adc__dev}{pios\-\_\-adc\-\_\-dev}
\item 
struct \hyperlink{structdma__config}{dma\-\_\-config}
\item 
struct \hyperlink{structadc__accumulator}{adc\-\_\-accumulator}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef \hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void}($\ast$ \hyperlink{group___p_i_o_s___a_d_c_ga20bf90833813c2c4945fab90c8e4f386}{A\-D\-C\-Callback} )(float $\ast$\hyperlink{pios__opahrs__proto_8h_a20e3f4bfaeccf09a75ef27e095a10112}{data})
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{group___p_i_o_s___a_d_c_gad4639b786d45b213ac842a0c4cf3e78d}{pios\-\_\-adc\-\_\-dev\-\_\-magic} \{ \hyperlink{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C} = 0x58375124, 
\hyperlink{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C} = 0x58375124
 \}
\item 
enum \hyperlink{group___p_i_o_s___a_d_c_gad4639b786d45b213ac842a0c4cf3e78d}{pios\-\_\-adc\-\_\-dev\-\_\-magic} \{ \hyperlink{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C} = 0x58375124, 
\hyperlink{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C} = 0x58375124
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___p_i_o_s___a_d_c_ga0edf09afa78da740bb49069ee8221b5c}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Config} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} oversampling)
\begin{DoxyCompactList}\small\item\em Configure the A\-D\-C to run at a fixed oversampling. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_gafd12020da5a235dfcf0c3c748fb5baed}{int32\-\_\-t} \hyperlink{group___p_i_o_s___a_d_c_ga014bdd5e97b33f0e3eb9b8b4318a8586}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Pin\-Get} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} pin)
\item 
\hyperlink{stdint_8h_aa343fa3b3d06292b959ffdd4c4703b06}{int16\-\_\-t} $\ast$ \hyperlink{group___p_i_o_s___a_d_c_ga8f65053761f8ff493734b8105528a3ab}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Raw\-Buffer} (\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void})
\begin{DoxyCompactList}\small\item\em Return the address of the raw data data buffer. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} \hyperlink{group___p_i_o_s___a_d_c_gaa343a6f620ddd80259e92ff0595cf977}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Over\-Sampling} (\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void})
\begin{DoxyCompactList}\small\item\em Return the amount of over sampling. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___p_i_o_s___a_d_c_gaba0959952db7ff67364a28ea801c41ec}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Callback} (\hyperlink{group___p_i_o_s___a_d_c_ga20bf90833813c2c4945fab90c8e4f386}{A\-D\-C\-Callback} new\-\_\-function)
\begin{DoxyCompactList}\small\item\em Set a callback function that is executed whenever the A\-D\-C double buffer swaps. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___p_i_o_s___a_d_c_ga27cf963b58fa9ab8f73ea6aedec43f74}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Queue} (\hyperlink{_common_2_libraries_2_free_r_t_o_s_2_source_2include_2queue_8h_a229037f755b756156e34a440ce134b8b}{x\-Queue\-Handle} data\-\_\-queue)
\begin{DoxyCompactList}\small\item\em Register a queue to add data to when downsampled. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___p_i_o_s___a_d_c_gad37f0d162db269d768666bd699df5ee8}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-M\-A\-\_\-\-Handler} (\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void})
\begin{DoxyCompactList}\small\item\em Interrupt for half and full buffer transfer. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_gafd12020da5a235dfcf0c3c748fb5baed}{int32\-\_\-t} \hyperlink{group___p_i_o_s___a_d_c_ga7182b35f2962ad07826b045eb987a33a}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Init} (\hyperlink{group___n_a_m_e_ga7ae6d0e43244213b34de2c2b9aa30da6}{const} struct \hyperlink{structpios__adc__cfg}{pios\-\_\-adc\-\_\-cfg} $\ast$cfg)
\begin{DoxyCompactList}\small\item\em Initialise the A\-D\-C Peripheral, configure to run at the max oversampling. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___p_i_o_s___a_d_c_ga1a45c599137a6722f7a8d30470e21bb2}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-downsample\-\_\-data} ()
\begin{DoxyCompactList}\small\item\em Downsample the data for each of the channels then call callback function if installed. \end{DoxyCompactList}\item 
float $\ast$ \hyperlink{group___p_i_o_s___a_d_c_ga0d2a803571d249493aa10774c9358f0f}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Buffer} (\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void})
\begin{DoxyCompactList}\small\item\em Return the address of the downsampled data buffer. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___p_i_o_s___a_d_c_gab2bb95efd8a061a377ae0d8cd60ca1ed}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-F\-I\-R\-Coefficients} (float $\ast$new\-\_\-filter)
\begin{DoxyCompactList}\small\item\em Set the fir coefficients. Takes as many samples as the current filter order plus one (normalization) \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___p_i_o_s___a_d_c_ga7cf4581a50ff57300061ea450f87a007}{accumulate} (\hyperlink{stdint_8h_a273cf69d639a59973b6019625df33e30}{uint16\-\_\-t} $\ast$buffer, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} count)
\begin{DoxyCompactList}\small\item\em accumulate the data for each of the channels. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structpios__adc__dev}{pios\-\_\-adc\-\_\-dev} $\ast$ \hyperlink{group___p_i_o_s___a_d_c_gab32db3584e1b8779726fcabc7aa2dc9a}{pios\-\_\-adc\-\_\-dev}
\item 
struct \hyperlink{structpios__adc__cfg}{pios\-\_\-adc\-\_\-cfg} \hyperlink{group___p_i_o_s___a_d_c_ga14da091ebda49e985ec01bc39f918eed}{pios\-\_\-adc\-\_\-cfg}
\item 
struct \hyperlink{structpios__adc__dev}{pios\-\_\-adc\-\_\-dev} $\ast$ \hyperlink{group___p_i_o_s___a_d_c_gab32db3584e1b8779726fcabc7aa2dc9a}{pios\-\_\-adc\-\_\-dev}
\item 
\hyperlink{group___n_a_m_e_gafd12020da5a235dfcf0c3c748fb5baed}{int32\-\_\-t} \hyperlink{group___p_i_o_s___a_d_c_ga093162eccbf300ef9e9fe2cfd9d956f6}{last\-\_\-conv\-\_\-value}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\-T\-M32 A\-D\-C P\-I\-O\-S interface. S\-T\-M32\-F4xx A\-D\-C P\-I\-O\-S interface.

P\-I\-O\-S interface for U\-S\-A\-R\-T port.

\subsection{Typedef Documentation}
\hypertarget{group___p_i_o_s___a_d_c_ga20bf90833813c2c4945fab90c8e4f386}{\index{A\-D\-C Functions@{A\-D\-C Functions}!A\-D\-C\-Callback@{A\-D\-C\-Callback}}
\index{A\-D\-C\-Callback@{A\-D\-C\-Callback}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{A\-D\-C\-Callback}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf void}($\ast$ A\-D\-C\-Callback)(float $\ast${\bf data})}}\label{group___p_i_o_s___a_d_c_ga20bf90833813c2c4945fab90c8e4f386}


Definition at line 37 of file pios\-\_\-adc.\-h.



\subsection{Enumeration Type Documentation}
\hypertarget{group___p_i_o_s___a_d_c_gad4639b786d45b213ac842a0c4cf3e78d}{\index{A\-D\-C Functions@{A\-D\-C Functions}!pios\-\_\-adc\-\_\-dev\-\_\-magic@{pios\-\_\-adc\-\_\-dev\-\_\-magic}}
\index{pios\-\_\-adc\-\_\-dev\-\_\-magic@{pios\-\_\-adc\-\_\-dev\-\_\-magic}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{pios\-\_\-adc\-\_\-dev\-\_\-magic}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf pios\-\_\-adc\-\_\-dev\-\_\-magic}}}\label{group___p_i_o_s___a_d_c_gad4639b786d45b213ac842a0c4cf3e78d}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}!A\-D\-C Functions@{A\-D\-C Functions}}\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}}\item[{\em 
\hypertarget{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}\label{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}
}]\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}!A\-D\-C Functions@{A\-D\-C Functions}}\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}}\item[{\em 
\hypertarget{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}\label{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}
}]\end{description}
\end{Desc}


Definition at line 35 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_gad4639b786d45b213ac842a0c4cf3e78d}{\index{A\-D\-C Functions@{A\-D\-C Functions}!pios\-\_\-adc\-\_\-dev\-\_\-magic@{pios\-\_\-adc\-\_\-dev\-\_\-magic}}
\index{pios\-\_\-adc\-\_\-dev\-\_\-magic@{pios\-\_\-adc\-\_\-dev\-\_\-magic}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{pios\-\_\-adc\-\_\-dev\-\_\-magic}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf pios\-\_\-adc\-\_\-dev\-\_\-magic}}}\label{group___p_i_o_s___a_d_c_gad4639b786d45b213ac842a0c4cf3e78d}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}!A\-D\-C Functions@{A\-D\-C Functions}}\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}}\item[{\em 
\hypertarget{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}\label{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}
}]\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}!A\-D\-C Functions@{A\-D\-C Functions}}\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}}\item[{\em 
\hypertarget{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-E\-V\-\_\-\-M\-A\-G\-I\-C}\label{group___p_i_o_s___a_d_c_ggad4639b786d45b213ac842a0c4cf3e78dab432edba8e4a3348b2f28cf7edf94f79}
}]\end{description}
\end{Desc}


Definition at line 67 of file pios\-\_\-adc.\-c.



\subsection{Function Documentation}
\hypertarget{group___p_i_o_s___a_d_c_ga7cf4581a50ff57300061ea450f87a007}{\index{A\-D\-C Functions@{A\-D\-C Functions}!accumulate@{accumulate}}
\index{accumulate@{accumulate}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{accumulate}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} accumulate (
\begin{DoxyParamCaption}
\item[{{\bf uint16\-\_\-t} $\ast$}]{buffer, }
\item[{{\bf uint32\-\_\-t}}]{count}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga7cf4581a50ff57300061ea450f87a007}


accumulate the data for each of the channels. 



Definition at line 323 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga0edf09afa78da740bb49069ee8221b5c}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Config@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Config}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Config@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Config}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Config}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Config (
\begin{DoxyParamCaption}
\item[{{\bf uint32\-\_\-t}}]{oversampling}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga0edf09afa78da740bb49069ee8221b5c}


Configure the A\-D\-C to run at a fixed oversampling. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em oversampling} & the amount of oversampling to run at \\
\hline
\end{DoxyParams}


Definition at line 134 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_gad37f0d162db269d768666bd699df5ee8}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-M\-A\-\_\-\-Handler@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-M\-A\-\_\-\-Handler}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-M\-A\-\_\-\-Handler@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-M\-A\-\_\-\-Handler}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-M\-A\-\_\-\-Handler}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-D\-M\-A\-\_\-\-Handler (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_gad37f0d162db269d768666bd699df5ee8}


Interrupt for half and full buffer transfer. 

Interrupt on buffer flip.

This interrupt handler swaps between the two halfs of the double buffer to make sure the ahrs uses the most recent data. Only swaps data when A\-H\-R\-S is idle, but really this is a pretense of a sanity check since the D\-M\-A engine is consantly running in the background. Keep an eye on the ekf\-\_\-too\-\_\-slow variable to make sure it's keeping up.

The hardware is done with the 'other' buffer, so we can pass it to the accumulator. 

Definition at line 343 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga1a45c599137a6722f7a8d30470e21bb2}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-downsample\-\_\-data@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-downsample\-\_\-data}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-downsample\-\_\-data@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-downsample\-\_\-data}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-downsample\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-downsample\-\_\-data (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga1a45c599137a6722f7a8d30470e21bb2}


Downsample the data for each of the channels then call callback function if installed. 



Definition at line 309 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga0d2a803571d249493aa10774c9358f0f}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Buffer@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Buffer}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Buffer@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Buffer}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Buffer}]{\setlength{\rightskip}{0pt plus 5cm}float $\ast$ P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Buffer (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga0d2a803571d249493aa10774c9358f0f}


Return the address of the downsampled data buffer. 

\begin{DoxyNote}{Note}
Not currently supported. 
\end{DoxyNote}


Definition at line 270 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_gaa343a6f620ddd80259e92ff0595cf977}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Over\-Sampling@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Over\-Sampling}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Over\-Sampling@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Over\-Sampling}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Over\-Sampling}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint8\-\_\-t} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Over\-Sampling (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_gaa343a6f620ddd80259e92ff0595cf977}


Return the amount of over sampling. 

\begin{DoxyNote}{Note}
Not currently supported (always returns 1) 
\end{DoxyNote}


Definition at line 286 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga8f65053761f8ff493734b8105528a3ab}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Raw\-Buffer@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Raw\-Buffer}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Raw\-Buffer@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Raw\-Buffer}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Raw\-Buffer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int16\-\_\-t} $\ast$ P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Get\-Raw\-Buffer (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga8f65053761f8ff493734b8105528a3ab}


Return the address of the raw data data buffer. 

\begin{DoxyNote}{Note}
Not currently supported. 
\end{DoxyNote}


Definition at line 278 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga7182b35f2962ad07826b045eb987a33a}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Init@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Init}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Init@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Init}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int32\-\_\-t} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Init (
\begin{DoxyParamCaption}
\item[{{\bf const} struct {\bf pios\-\_\-adc\-\_\-cfg} $\ast$}]{cfg}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga7182b35f2962ad07826b045eb987a33a}


Initialise the A\-D\-C Peripheral, configure to run at the max oversampling. 

Init the A\-D\-C. 

Definition at line 100 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga014bdd5e97b33f0e3eb9b8b4318a8586}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Pin\-Get@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Pin\-Get}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Pin\-Get@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Pin\-Get}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Pin\-Get}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int32\-\_\-t} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Pin\-Get (
\begin{DoxyParamCaption}
\item[{{\bf uint32\-\_\-t}}]{pin}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga014bdd5e97b33f0e3eb9b8b4318a8586}
Returns value of an A\-D\-C Pin 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pin} & number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A\-D\-C pin value -\/ resolution depends on the selected oversampling rate 

-\/1 if pin doesn't exist
\end{DoxyReturn}
Returns value of an A\-D\-C Pin 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pin} & number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A\-D\-C pin value averaged over the set of samples since the last reading. 

-\/1 if pin doesn't exist 
\end{DoxyReturn}


Definition at line 237 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_gaba0959952db7ff67364a28ea801c41ec}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Callback@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Callback}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Callback@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Callback}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Callback}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Callback (
\begin{DoxyParamCaption}
\item[{{\bf A\-D\-C\-Callback}}]{new\-\_\-function}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_gaba0959952db7ff67364a28ea801c41ec}


Set a callback function that is executed whenever the A\-D\-C double buffer swaps. 

\begin{DoxyNote}{Note}
Not currently supported. 
\end{DoxyNote}


Definition at line 252 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_gab2bb95efd8a061a377ae0d8cd60ca1ed}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-F\-I\-R\-Coefficients@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-F\-I\-R\-Coefficients}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-F\-I\-R\-Coefficients@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-F\-I\-R\-Coefficients}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-F\-I\-R\-Coefficients}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-F\-I\-R\-Coefficients (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{new\-\_\-filter}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_gab2bb95efd8a061a377ae0d8cd60ca1ed}


Set the fir coefficients. Takes as many samples as the current filter order plus one (normalization) 


\begin{DoxyParams}{Parameters}
{\em new\-\_\-filter} & Array of adc\-\_\-oversampling floats plus one for the filter coefficients\\
\hline
{\em new\-\_\-filter} & Array of adc\-\_\-oversampling floats plus one for the filter coefficients \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Not currently supported. 
\end{DoxyNote}


Definition at line 298 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga27cf963b58fa9ab8f73ea6aedec43f74}{\index{A\-D\-C Functions@{A\-D\-C Functions}!P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Queue@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Queue}}
\index{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Queue@{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Queue}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Queue}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} P\-I\-O\-S\-\_\-\-A\-D\-C\-\_\-\-Set\-Queue (
\begin{DoxyParamCaption}
\item[{{\bf x\-Queue\-Handle}}]{data\-\_\-queue}
\end{DoxyParamCaption}
)}}\label{group___p_i_o_s___a_d_c_ga27cf963b58fa9ab8f73ea6aedec43f74}


Register a queue to add data to when downsampled. 

\begin{DoxyNote}{Note}
Not currently supported. 
\end{DoxyNote}


Definition at line 261 of file pios\-\_\-adc.\-c.



\subsection{Variable Documentation}
\hypertarget{group___p_i_o_s___a_d_c_ga093162eccbf300ef9e9fe2cfd9d956f6}{\index{A\-D\-C Functions@{A\-D\-C Functions}!last\-\_\-conv\-\_\-value@{last\-\_\-conv\-\_\-value}}
\index{last\-\_\-conv\-\_\-value@{last\-\_\-conv\-\_\-value}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{last\-\_\-conv\-\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int32\-\_\-t} last\-\_\-conv\-\_\-value}}\label{group___p_i_o_s___a_d_c_ga093162eccbf300ef9e9fe2cfd9d956f6}
Returns value of an A\-D\-C Pin 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pin} & number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A\-D\-C pin value averaged over the set of samples since the last reading. 

-\/1 if pin doesn't exist 

-\/2 if no data acquired since last read 
\end{DoxyReturn}


Definition at line 297 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_ga14da091ebda49e985ec01bc39f918eed}{\index{A\-D\-C Functions@{A\-D\-C Functions}!pios\-\_\-adc\-\_\-cfg@{pios\-\_\-adc\-\_\-cfg}}
\index{pios\-\_\-adc\-\_\-cfg@{pios\-\_\-adc\-\_\-cfg}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{pios\-\_\-adc\-\_\-cfg}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf pios\-\_\-adc\-\_\-cfg} {\bf pios\-\_\-adc\-\_\-cfg}}}\label{group___p_i_o_s___a_d_c_ga14da091ebda49e985ec01bc39f918eed}
\hypertarget{group___p_i_o_s___a_d_c_gab32db3584e1b8779726fcabc7aa2dc9a}{\index{A\-D\-C Functions@{A\-D\-C Functions}!pios\-\_\-adc\-\_\-dev@{pios\-\_\-adc\-\_\-dev}}
\index{pios\-\_\-adc\-\_\-dev@{pios\-\_\-adc\-\_\-dev}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{pios\-\_\-adc\-\_\-dev}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf pios\-\_\-adc\-\_\-dev}$\ast$ {\bf pios\-\_\-adc\-\_\-dev}}}\label{group___p_i_o_s___a_d_c_gab32db3584e1b8779726fcabc7aa2dc9a}


Definition at line 58 of file pios\-\_\-adc.\-c.

\hypertarget{group___p_i_o_s___a_d_c_gab32db3584e1b8779726fcabc7aa2dc9a}{\index{A\-D\-C Functions@{A\-D\-C Functions}!pios\-\_\-adc\-\_\-dev@{pios\-\_\-adc\-\_\-dev}}
\index{pios\-\_\-adc\-\_\-dev@{pios\-\_\-adc\-\_\-dev}!ADC Functions@{A\-D\-C Functions}}
\subsubsection[{pios\-\_\-adc\-\_\-dev}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf pios\-\_\-adc\-\_\-dev}$\ast$ {\bf pios\-\_\-adc\-\_\-dev}}}\label{group___p_i_o_s___a_d_c_gab32db3584e1b8779726fcabc7aa2dc9a}


Definition at line 87 of file pios\-\_\-adc.\-c.

