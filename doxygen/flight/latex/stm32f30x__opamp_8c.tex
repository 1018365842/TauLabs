\hypertarget{stm32f30x__opamp_8c}{\section{/home/jose/\-Code/gui\-Tau/flight/\-Pi\-O\-S/\-S\-T\-M32\-F30x/\-Libraries/\-S\-T\-M32\-F30x\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f30x\-\_\-opamp.c File Reference}
\label{stm32f30x__opamp_8c}\index{/home/jose/\-Code/gui\-Tau/flight/\-Pi\-O\-S/\-S\-T\-M32\-F30x/\-Libraries/\-S\-T\-M32\-F30x\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f30x\-\_\-opamp.\-c@{/home/jose/\-Code/gui\-Tau/flight/\-Pi\-O\-S/\-S\-T\-M32\-F30x/\-Libraries/\-S\-T\-M32\-F30x\-\_\-\-Std\-Periph\-\_\-\-Driver/src/stm32f30x\-\_\-opamp.\-c}}
}


This file provides firmware functions to manage the following functionalities of the operational amplifiers (O\-P\-A\-M\-P1,...O\-P\-A\-M\-P4) peripheral\-:  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_gaa4bbf6664a065c5d03403a44a2766812}{O\-P\-A\-M\-P\-\_\-\-De\-Init} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection)
\begin{DoxyCompactList}\small\item\em Deinitializes O\-P\-A\-M\-P peripheral registers to their default reset values. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_ga09d484350c3bded9efde1e49b94e6ec3}{O\-P\-A\-M\-P\-\_\-\-Init} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, O\-P\-A\-M\-P\-\_\-\-Init\-Type\-Def $\ast$O\-P\-A\-M\-P\-\_\-\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Initializes the O\-P\-A\-M\-P peripheral according to the specified parameters in O\-P\-A\-M\-P\-\_\-\-Init\-Struct. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_ga15fee15afc081d1e8d5e8bf0f83bbc27}{O\-P\-A\-M\-P\-\_\-\-Struct\-Init} (O\-P\-A\-M\-P\-\_\-\-Init\-Type\-Def $\ast$O\-P\-A\-M\-P\-\_\-\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Fills each O\-P\-A\-M\-P\-\_\-\-Init\-Struct member with its default value. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_gacb2fa995bd31564778508406f4da0397}{O\-P\-A\-M\-P\-\_\-\-P\-G\-A\-Config} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-P\-G\-A\-Gain, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-P\-G\-A\-Connect)
\begin{DoxyCompactList}\small\item\em Configure the feedback resistor gain. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_gafda4e9c439f856b12391f6f3036dfecd}{O\-P\-A\-M\-P\-\_\-\-Vref\-Config} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Vref)
\begin{DoxyCompactList}\small\item\em Configure the O\-P\-A\-M\-P's internal reference. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_ga8f71e81ecc647c4b7d6388b8ec609911}{O\-P\-A\-M\-P\-\_\-\-Vref\-Connect\-Non\-Inverting\-Input} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{group___exported__types_gac9a7e9a35d2513ec15c3b537aaa4fba1}{Functional\-State} New\-State)
\begin{DoxyCompactList}\small\item\em Connnect the internal reference to the O\-P\-A\-M\-P's non inverting input. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_gafbd4b42c92fbbdad884283002636563a}{O\-P\-A\-M\-P\-\_\-\-Vref\-Connect\-A\-D\-C\-Cmd} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{group___exported__types_gac9a7e9a35d2513ec15c3b537aaa4fba1}{Functional\-State} New\-State)
\begin{DoxyCompactList}\small\item\em Enables or disables connecting the O\-P\-A\-M\-P's internal reference to A\-D\-C. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_gafb03a64bdcbc41ee0ca8d3b67f1059e7}{O\-P\-A\-M\-P\-\_\-\-Timer\-Controlled\-Mux\-Config} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, O\-P\-A\-M\-P\-\_\-\-Init\-Type\-Def $\ast$O\-P\-A\-M\-P\-\_\-\-Init\-Struct)
\begin{DoxyCompactList}\small\item\em Configure the O\-P\-A\-M\-P peripheral (secondary inputs) for timer-\/controlled mux mode according to the specified parameters in O\-P\-A\-M\-P\-\_\-\-Init\-Struct. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_ga0ec52a389f45403f60f71a32a3ad36f0}{O\-P\-A\-M\-P\-\_\-\-Timer\-Controlled\-Mux\-Cmd} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{group___exported__types_gac9a7e9a35d2513ec15c3b537aaa4fba1}{Functional\-State} New\-State)
\begin{DoxyCompactList}\small\item\em Enable or disable the timer-\/controlled mux mode. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_gac5214b0a1166baf40cdc971e41c777da}{O\-P\-A\-M\-P\-\_\-\-Cmd} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{group___exported__types_gac9a7e9a35d2513ec15c3b537aaa4fba1}{Functional\-State} New\-State)
\begin{DoxyCompactList}\small\item\em Enable or disable the O\-P\-A\-M\-P peripheral. \end{DoxyCompactList}\item 
\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} \hyperlink{group___o_p_a_m_p___group1_ga4d3e1535b9bbe1f7540bf46401e92469}{O\-P\-A\-M\-P\-\_\-\-Get\-Output\-Level} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection)
\begin{DoxyCompactList}\small\item\em Return the output level (high or low) during calibration of the selected O\-P\-A\-M\-P. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_ga3d67a254b057003e947137b48a61e2db}{O\-P\-A\-M\-P\-\_\-\-Offset\-Trim\-Mode\-Select} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Trimming)
\begin{DoxyCompactList}\small\item\em Select the trimming mode. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_gaadd8bba707d7641bbf42da7f5b7ad64b}{O\-P\-A\-M\-P\-\_\-\-Offset\-Trim\-Config} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Input, \hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Trim\-Value)
\begin{DoxyCompactList}\small\item\em Configure the trimming value of the O\-P\-A\-M\-P. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group1_ga79a02d17e67866e3dc85f0cab0cbae3a}{O\-P\-A\-M\-P\-\_\-\-Start\-Calibration} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection, \hyperlink{group___exported__types_gac9a7e9a35d2513ec15c3b537aaa4fba1}{Functional\-State} New\-State)
\begin{DoxyCompactList}\small\item\em Start or stop the calibration of selected O\-P\-A\-M\-P peripheral. \end{DoxyCompactList}\item 
\hyperlink{group___n_a_m_e_ga18028b8badbf1ea7e704ccac3c488e82}{void} \hyperlink{group___o_p_a_m_p___group2_gabd6873598109d36b07146c1ad34079bc}{O\-P\-A\-M\-P\-\_\-\-Lock\-Config} (\hyperlink{stdint_8h_a435d1572bf3f880d55459d9805097f62}{uint32\-\_\-t} O\-P\-A\-M\-P\-\_\-\-Selection)
\begin{DoxyCompactList}\small\item\em Lock the selected O\-P\-A\-M\-P configuration. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file provides firmware functions to manage the following functionalities of the operational amplifiers (O\-P\-A\-M\-P1,...O\-P\-A\-M\-P4) peripheral\-: \begin{DoxyAuthor}{Author}
M\-C\-D Application Team 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
V1.\-0.\-0 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
04-\/\-September-\/2012
\begin{DoxyItemize}
\item O\-P\-A\-M\-P Configuration
\item O\-P\-A\-M\-P calibration
\end{DoxyItemize}
\end{DoxyDate}
\begin{DoxyVerb}==============================================================================
                      ##### OPAMP Peripheral Features #####
==============================================================================
                 
[..]
    The device integrates 4 operational amplifiers OPAMP1, OPAMP2, OPAMP3 and OPAMP4:
            
    (+) The OPAMPs non inverting input can be selected among the list shown by
        table below.

    (+) The OPAMPs inverting input can be selected among the list shown by
        table below.

    (+) The OPAMPs outputs can be internally connected to the inverting input 
        (follower mode)
    (+) The OPAMPs outputs can be internally connected to resistor feedback
        output (Programmable Gain Amplifier mode)

    (+) The OPAMPs outputs can be internally connected to ADC

    (+) The OPAMPs can be calibrated to compensate the offset compensation

    (+) Timer-controlled Mux for automatic switch of inverting and
        non-inverting input

OPAMPs inverting/non-inverting inputs:
  +--------------------------------------------------------------+     
  |                 |        | OPAMP1 | OPAMP2 | OPAMP3 | OPAMP4 |
  |-----------------|--------|--------|--------|--------|--------|
  |                 | PGA    |  OK    |  OK    |  OK    |  OK    |
  | Inverting Input | Vout   |  OK    |  OK    |  OK    |  OK    |
  |                 | IO1    |  PC5   |  PC5   |  PB10  |  PB10  |
  |                 | IO2    |  PA3   |  PA5   |  PB2   |  PD8   |
  |-----------------|--------|--------|--------|--------|--------|
  |                 | IO1    |  PA7   |  PD14  |  PB13  |  PD11  |
  |  Non Inverting  | IO2    |  PA5   |  PB14  |  PA5   |  PB11  |
  |    Input        | IO3    |  PA3   |  PB0   |  PA1   |  PA4   |
  |                 | IO4    |  PA1   |  PA7   |  PB0   |  PB13  |
  +--------------------------------------------------------------+  

                      ##### How to use this driver #####
==============================================================================
[..]
This driver provides functions to configure and program the OPAMP 
of all STM32F30x devices.

To use the OPAMP, perform the following steps:

(#) Enable the SYSCFG APB clock to get write access to OPAMP
    register using RCC_APB2PeriphClockCmd(RCC_APB2Periph_SYSCFG, ENABLE);

(#) Configure the OPAMP input in analog mode using GPIO_Init()

(#) Configure the OPAMP using OPAMP_Init() function:
    (++) Select the inverting input
    (++) Select the non-inverting inverting input
  
(#) Enable the OPAMP using OPAMP_Cmd() function\end{DoxyVerb}


\begin{DoxyAttention}{Attention}

\end{DoxyAttention}
\subsubsection*{\begin{center}\copyright C\-O\-P\-Y\-R\-I\-G\-H\-T 2012 S\-T\-Microelectronics\end{center} }

Licensed under M\-C\-D-\/\-S\-T Liberty S\-W License Agreement V2, (the \char`\"{}\-License\char`\"{}); You may not use this file except in compliance with the License. You may obtain a copy of the License at\-: \begin{DoxyVerb}   http://www.st.com/software_license_agreement_liberty_v2
\end{DoxyVerb}


Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \char`\"{}\-A\-S I\-S\char`\"{} B\-A\-S\-I\-S, W\-I\-T\-H\-O\-U\-T W\-A\-R\-R\-A\-N\-T\-I\-E\-S O\-R C\-O\-N\-D\-I\-T\-I\-O\-N\-S O\-F A\-N\-Y K\-I\-N\-D, either express or implied. See the License for the specific language governing permissions and limitations under the License. 

Definition in file \hyperlink{stm32f30x__opamp_8c_source}{stm32f30x\-\_\-opamp.\-c}.

